function chooseAddress(e){var t=$(e).parents("tbody").find("input[type='radio']");$.each(t,function(e,t){$(t).prop("checked",!1)}),$(e).children("input").prop("checked",!0),$(e).parents("tbody").find("div").removeClass("address-background-set"),$(e).addClass("address-background-set")}function choosePayType(e){$(".payment-selected").removeClass("payment-selected"),$(e).addClass("payment-selected")}function chooseShippingType(e){$(".shipping-selected").removeClass("shipping-selected"),$(e).addClass("shipping-selected")}function confirm(){if(null==_addressList||void 0==_addressList)return EPC.alertFuc("暂无可用收货地址，无法提交订单，请联系400-9937-288"),!1;JqUI.loading(_body);var e=getSellerList();return"boolean"==typeof e?(JqUI.unblockUI(_body),!1):void JqAjax.postJson("/buy/order/submitOrder",function(e){if(e.success){var t=e.data;if(t.length>1)return void(window.location.href="/part/pay/selectWaitPayOrder?orderSn="+t[0]);var r=$(".payment-selected").data("code");if(void 0==r)return;switch(r){case"alipay":window.location.href="/part/pay/aliPay?orderSn="+t[0];break;case"lianpay":window.location.href="/part/pay/selectUnionPay?orderSn="+t[0]}}else LayerUtil.msgFun(e.message,function(){location.reload()});JqUI.unblockUI(_body)},JSON.stringify(e))}function getSellerList(){var e=JSON.parse($("#sellerList").val());if(null==e)return LayerUtil.msg("商品信息异常，请重新核对"),!1;for(var t=[],r=0;r<e.length;r++){for(var n=[],a=$("#order-note-"+e[r].sellerId).val(),o=e[r].goodsList.length,i=0;o>i;i++){var s=e[r].goodsList[i],c={goodsId:s.goodsId,goodsSn:s.goodsSn,partName:s.partName,oeNumber:s.oeNumber,goodsNumber:s.goodsNumber,goodsPrice:s.goodsPrice};n.push(c)}var l={sellerId:e[r].sellerId,sellerTelephone:e[r].sellerTelephone,sellerCompanyName:e[r].sellerCompanyName,orderNote:a,goodsParamList:n};t.push(l)}var u=checkUserAddress();return"boolean"==typeof u?!1:(u.sellerList=t,u)}function checkUserAddress(){var e,t,r,n,a,o,i,s=$("input[name='address']:checked").attr("id");$.each(_addressList,function(c,l){return s==l.id?(e=l.contactsName,t=l.mobile,r=l.provinceId,n=l.cityId,a=l.districtId,o=l.streetId,i=l.address,!1):void 0});var c=$("#supplier_name").val().trim(),l=$(".shipping-selected"),u=$(".payment-selected"),d=$("input[name='receipt']:checked"),p={companyName:c,consignee:e,mobile:t,province:r,city:n,district:a,street:o,address:i,shippingId:l.data("value"),shippingName:l.data("name"),payId:u.data("value"),payName:u.data("name"),invType:d.data("id"),sellerList:void 0};return void 0!=_buyNow&&(p.buyNow=1),p}function getTaxRate(){var e=JSON.parse($("#sellerList").val()),t=[];$.each(e,function(e,r){t.push(r.sellerId)});var r=t.join(",");JqAjax.get("/shopping/getTaxRateMap",function(t){if(t.success){var r=0,n=t.data;$.each(n,function(t,n){$.each(e,function(e,a){t==a.sellerId&&$.each(a.goodsList,function(e,t){var a=mul(t.goodsPrice,n),o=add(t.goodsPrice,a);$("#goodsPrice"+t.id).text(EPC.parseMoney(o));var i=mul(EPC.parseMoney(o),t.goodsNumber);$("#goodsPriceAmount"+t.id).text(EPC.parseMoney(i)),r+=parseFloat(EPC.parseMoney(i))})})}),$("#total").text(EPC.parseMoney(r))}},{orgIdStr:r})}function noTaxRate(){var e=0,t=JSON.parse($("#sellerList").val());$.each(t,function(t,r){$.each(r.goodsList,function(t,r){$("#goodsPrice"+r.id).text(EPC.parseMoney(r.goodsPrice));var n=mul(EPC.parseMoney(r.goodsPrice),r.goodsNumber);$("#goodsPriceAmount"+r.id).text(EPC.parseMoney(n)),e+=parseFloat(EPC.parseMoney(n))})}),$("#total").text(EPC.parseMoney(e))}function addTaxPrice(){var e=0,t=JSON.parse($("#sellerList").val());JqAjax.get("/shopping/getAddTax",function(r){r.success&&($.each(t,function(t,n){$.each(n.goodsList,function(t,n){var a=mul(n.goodsPrice,r.data),o=add(n.goodsPrice,a);$("#goodsPrice"+n.id).text(EPC.parseMoney(o));var i=mul(EPC.parseMoney(o),n.goodsNumber);$("#goodsPriceAmount"+n.id).text(EPC.parseMoney(i)),e+=parseFloat(EPC.parseMoney(i))})}),$("#total").text(EPC.parseMoney(e)))})}function add(e,t){var r,n,a;try{r=e.toString().split(".")[1].length}catch(o){r=0}try{n=t.toString().split(".")[1].length}catch(o){n=0}return a=Math.pow(10,Math.max(r,n)),(mul(e,a)+mul(t,a))/a}function sub(e,t){var r,n,a;try{r=e.toString().split(".")[1].length}catch(o){r=0}try{n=t.toString().split(".")[1].length}catch(o){n=0}return a=Math.pow(10,Math.max(r,n)),(mul(e,a)-mul(t,a))/a}function mul(e,t){var r=0,n=e.toString(),a=t.toString();try{r+=n.split(".")[1].length}catch(o){}try{r+=a.split(".")[1].length}catch(o){}return Number(n.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,r)}function div(e,t){var r,n,a=0,o=0;try{a=e.toString().split(".")[1].length}catch(i){}try{o=t.toString().split(".")[1].length}catch(i){}return r=Number(e.toString().replace(".","")),n=Number(t.toString().replace(".","")),mul(r/n,Math.pow(10,o-a))}!function(){function e(e){return e.replace(y,"").replace(b,",").replace(w,"").replace(P,"").replace(x,"").split(C)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function r(r,n){function a(e){return p+=e.split(/\n/).length-1,u&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=v[1]+t(e)+v[2]+"\n"),e}function o(t){var r=p;if(l?t=l(t,n):i&&(t=t.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===t.indexOf("=")){var a=d&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),a){var o=t.replace(/\s*\([^\)]+\)/,"");f[o]||/^(include|print)$/.test(o)||(t="$escape("+t+")")}else t="$string("+t+")";t=v[1]+t+v[2]}return i&&(t="$line="+r+";"+t),m(e(t),function(e){if(e&&!h[e]){var t;t="print"===e?b:"include"===e?w:f[e]?"$utils."+e:g[e]?"$helpers."+e:"$data."+e,P+=e+"="+t+",",h[e]=!0}}),t+"\n"}var i=n.debug,s=n.openTag,c=n.closeTag,l=n.parser,u=n.compress,d=n.escape,p=1,h={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},$="".trim,v=$?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=$?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+y+"}",w="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",P="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),x=v[0],C="return new String("+v[3]+");";m(r.split(s),function(e){e=e.split(c);var t=e[0],r=e[1];1===e.length?x+=a(t):(x+=o(t),r&&(x+=a(r)))});var N=P+x+C;i&&(N="try{"+N+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(r)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var S=new Function("$data","$filename",N);return S.prototype=f,S}catch(M){throw M.temp="function anonymous($data,$filename) {"+N+"}",M}}var n=function(e,t){return"string"==typeof t?$(t,{filename:e}):i(e,t)};n.version="3.0.0",n.config=function(e,t){a[e]=t};var a=n.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},o=n.cache={};n.render=function(e,t){return $(e,t)};var i=n.renderFile=function(e,t){var r=n.get(e)||h({filename:e,name:"Render Error",message:"Template not found"});return t?r(t):r};n.get=function(e){var t;if(o[e])t=o[e];else if("object"==typeof document){var r=document.getElementById(e);if(r){var n=(r.value||r.innerHTML).replace(/^\s*|\s*$/g,"");t=$(n,{filename:e})}}return t};var s=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?s(e.call(e)):""),e},c={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},l=function(e){return c[e]},u=function(e){return s(e).replace(/&(?![\w#]+;)|[<>"']/g,l)},d=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,t){var r,n;if(d(e))for(r=0,n=e.length;n>r;r++)t.call(e,e[r],r,e);else for(r in e)t.call(e,e[r],r)},f=n.utils={$helpers:{},$include:i,$string:s,$escape:u,$each:p};n.helper=function(e,t){g[e]=t};var g=n.helpers=f.$helpers;n.onerror=function(e){var t="Template Error\n\n";for(var r in e)t+="<"+r+">\n"+e[r]+"\n\n";"object"==typeof console&&console.error(t)};var h=function(e){return n.onerror(e),function(){return"{Template Error}"}},$=n.compile=function(e,t){function n(r){try{return new c(r,s)+""}catch(n){return t.debug?h(n)():(t.debug=!0,$(e,t)(r))}}t=t||{};for(var i in a)void 0===t[i]&&(t[i]=a[i]);var s=t.filename;try{var c=r(e,t)}catch(l){return l.filename=s||"anonymous",l.name="Syntax Error",h(l)}return n.prototype=c.prototype,n.toString=function(){return c.toString()},s&&t.cache&&(o[s]=n),n},m=f.$each,v="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,w=new RegExp(["\\b"+v.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),P=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g,C=/^$|,+/;a.openTag="{{",a.closeTag="}}";var N=function(e,t){var r=t.split(":"),n=r.shift(),a=r.join(":")||"";return a&&(a=", "+a),"$helpers."+n+"("+e+a+")"};a.parser=function(e){e=e.replace(/^\s/,"");var t=e.split(" "),r=t.shift(),a=t.join(" ");switch(r){case"if":e="if("+a+"){";break;case"else":t="if"===t.shift()?" if("+t.join(" ")+")":"",e="}else"+t+"{";break;case"/if":e="}";break;case"each":var o=t[0]||"$data",i=t[1]||"as",s=t[2]||"$value",c=t[3]||"$index",l=s+","+c;"as"!==i&&(o="[]"),e="$each("+o+",function("+l+"){";break;case"/each":e="});";break;case"echo":e="print("+a+");";break;case"print":case"include":e=r+"("+t.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(a)){var u=!0;0===e.indexOf("#")&&(e=e.substr(1),u=!1);for(var d=0,p=e.split("|"),f=p.length,g=p[d++];f>d;d++)g=N(g,p[d]);e=(u?"=":"=#")+g}else e=n.helpers[r]?"=#"+r+"("+t.join(",")+");":"="+e}return e},"function"==typeof define?define(function(){return n}):"undefined"!=typeof exports?module.exports=n:this.template=n}();var _body=$("body"),_addressList,_buyNow;$(function(){""!=$("#buyNow").val()&&(_buyNow=1),_addressList=JSON.parse($("#addressList").val()),ImgUtil.init($(".goods-info-img-set"),["click"]);for(var e=0,t=$(".singleTotal"),r=0;r<t.length;r++)e+=parseFloat(t[r].innerText);$("#total").text(EPC.parseMoney(e)),$(".seller-chat").unbind("click").click(function(){var e=$(this).data("orgid");TqmallChat.openChatWindow(e,"yunpei",void 0,WishChatMap.bottom_url,WishChatMap.bottom_url_btn_name,WishChatMap.guide_url,WishChatMap.guide_content)})});