function changeSearchType(e,t){TipUtil.removeTip();var a=$("#car-type-search-input");switch(a.val(""),$(".choose-style").removeClass("choose-style"),$(t).addClass("choose-style"),e){case 0:a.unbind("keyup"),a.attr("placeholder",_keywordSearchPlaceholder),a.removeAttr("maxlength");break;case 1:a.unbind("keyup").on("keyup",function(){$(this).val($(this).val().replace(/[\u4E00-\u9FA5]/g,""))}),a.attr("placeholder",_oeSearchPlaceholder),a.removeAttr("maxlength");break;default:a.unbind("keyup").on("keyup",function(){$(this).val($(this).val().replace(/[\u4E00-\u9FA5]/g,""))}),a.attr("placeholder",_vinSearchPlaceholder),a.attr("maxlength",_vinLength)}a.focus()}function carSearch(){var e=$("#car-type-search-input");TipUtil.destroyTip(e);var t=Number($(".choose-style").attr("data-type")),a=e.val().trim();if(0==t){if(""==a)return TipUtil.tooltipFun(e,_keywordSearchTip,"bottom"),!1;window.location.href="/autoParts/goods/keyword?q="+a}if(1==t){if(""==a)return TipUtil.tooltipFun(e,_oeSearchTip,"bottom"),!1;window.location.href="/autoParts/goods/oe?oem="+a}if(2==t){if(a=a.toUpperCase(),!EPC.isVin(a))return TipUtil.tooltipFun(e,_vinSearchTip,"bottom"),!1;JqAjax.post("/epc/car/getOnlineCarByVin",getVinResult,{vin:a})}}function getVinResult(e){var t=$("#car-type-search-input").val().trim(),a="/autoParts/category/category?carId=CARID&vinNumber="+t;if(e.success){var r=e.data;if(1==r.length)window.location.href=a.replace("CARID",r[0].id)+"&seriesId="+r[0].seriesId;else{var o=template("choose_car_template",{list:r});EPC.alertFuc(o),$(".choose_car").unbind("click").click(function(){var e=$(this).attr("data-id"),t=$(this).attr("data-sid");window.location.href=a.replace("CARID",e)+"&seriesId="+t})}}else EPC.alertFuc("很抱歉，未查询到您提交的车辆信息。");return!1}function init_variable(){_goodsId=$("#goodsId").val(),_modelId=$("#modelId").val()}function initQualitySelect(){JqAjax.get("/common/getGoodsQuality",function(e){e.success&&$("#chooseQuality").html(template("chooseQualityTemplate",{dataList:e.data}))})}function getCarByGoodsId(){JqUI.loading(_body),JqAjax.get("/autoParts/carForGoods",function(e){e.success?(e.data.modelId=_modelId,$("#partLeft").html(template("carModelTemplate",e.data)),$("#selectCarModel span").css("border","1px solid #F5F9FC"),_carListMap=e.data.carListMap,selectCarModel($(".car-model-selected").get(0))):($("#partLeft").html("没有适配车型"),$("#partLeftDown").html("没有适配车款")),JqUI.unblockUI(_body)},{goodsId:_goodsId})}function selectCarModel(e){if($(".car-model-span").removeClass("car-model-selected"),void 0===e){var t=$(".car-model-span:first");t.addClass("car-model-selected"),_carArray=_carListMap[t.attr("data-id")]}else $(e).addClass("car-model-selected"),_carArray=_carListMap[$(e).attr("data-id")];_carArray.sort(function(e,t){return e.name>=t.name?1:-1}),$("#partLeftDown").html(template("carTemplate",{carList:_carArray})),selectCar($(".car-li:first"))}function selectCar(e){$(".car-li").removeClass("car-model-selected"),$(e).addClass("car-model-selected"),_carId=$(e).attr("data-id"),getOfferInfo(),JqUI.loading(_body),JqAjax.get("/autoParts/getGoodsDetail",function(e){if(e.success){$("#goodsDetail").html(template("goodsDetailTemplate",e.data));var t=e.data.epcPicList;(null==t||void 0==t||0==t.length)&&(t=["/img/no-pic-big.png"]),$("#pictureList").html(template("pictureListTemplate",{dataList:t})),$("#bigPicture").attr("src",t[0]);var a="/goods/picGoods?picNum="+e.data.epcPicNum+"&carId="+_carId;$("#showPicGoods").attr("href",a)}JqUI.unblockUI(_body)},{goodsId:_goodsId,carId:_carId})}function changePicture(e){$(".picture-border").removeClass("picture-border"),$(e).addClass("picture-border");var t=$(e).attr("src");$("#bigPicture").attr("src",t)}function getOfferInfo(){_oeNumber=$("#oeNumber").data("title"),_partName=$("#partName").data("title");var e=$("#qualitySelect").val();Shopping.getOfferInfo(_carId,_oeNumber,e,_partName)}function offeringFilter(e){var t=e.value;Shopping.getOfferInfo(_carId,_oeNumber,t,_partName)}function changeNum(e,t){var a=$(e).parent().children("input[type='text']").val(),r=parseInt(a);return 1==r&&0>t?!1:(r+=t,r>_goodsNumLimit&&(LayerUtil.msg("非常抱歉，已超最大库存"),r=_goodsNumLimit),void $(e).parent().children("input[type='text']").val(r))}function changeInputNum(e){var t=$(e).val().trim();return""==t||0==t.substring(0,1)?void $(e).val(1):void(!isNaN(t)&&/^\d+$/.test(t)?(t>_goodsNumLimit&&(LayerUtil.msg("非常抱歉，已超最大库存"),t=_goodsNumLimit),$(e).val(t)):$(e).val(1))}!function(){function e(e){return e.replace(y,"").replace(b,",").replace(I,"").replace(_,"").replace(k,"").split(N)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function a(a,r){function o(e){return p+=e.split(/\n/).length-1,u&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=v[1]+t(e)+v[2]+"\n"),e}function n(t){var a=p;if(s?t=s(t,r):i&&(t=t.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===t.indexOf("=")){var o=d&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),o){var n=t.replace(/\s*\([^\)]+\)/,"");f[n]||/^(include|print)$/.test(n)||(t="$escape("+t+")")}else t="$string("+t+")";t=v[1]+t+v[2]}return i&&(t="$line="+a+";"+t),$(e(t),function(e){if(e&&!h[e]){var t;t="print"===e?b:"include"===e?I:f[e]?"$utils."+e:m[e]?"$helpers."+e:"$data."+e,_+=e+"="+t+",",h[e]=!0}}),t+"\n"}var i=r.debug,c=r.openTag,l=r.closeTag,s=r.parser,u=r.compress,d=r.escape,p=1,h={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},g="".trim,v=g?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=g?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+y+"}",I="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",_="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),k=v[0],N="return new String("+v[3]+");";$(a.split(c),function(e){e=e.split(l);var t=e[0],a=e[1];1===e.length?k+=o(t):(k+=n(t),a&&(k+=o(a)))});var w=_+k+N;i&&(w="try{"+w+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(a)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var C=new Function("$data","$filename",w);return C.prototype=f,C}catch(S){throw S.temp="function anonymous($data,$filename) {"+w+"}",S}}var r=function(e,t){return"string"==typeof t?g(t,{filename:e}):i(e,t)};r.version="3.0.0",r.config=function(e,t){o[e]=t};var o=r.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},n=r.cache={};r.render=function(e,t){return g(e,t)};var i=r.renderFile=function(e,t){var a=r.get(e)||h({filename:e,name:"Render Error",message:"Template not found"});return t?a(t):a};r.get=function(e){var t;if(n[e])t=n[e];else if("object"==typeof document){var a=document.getElementById(e);if(a){var r=(a.value||a.innerHTML).replace(/^\s*|\s*$/g,"");t=g(r,{filename:e})}}return t};var c=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?c(e.call(e)):""),e},l={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},s=function(e){return l[e]},u=function(e){return c(e).replace(/&(?![\w#]+;)|[<>"']/g,s)},d=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,t){var a,r;if(d(e))for(a=0,r=e.length;r>a;a++)t.call(e,e[a],a,e);else for(a in e)t.call(e,e[a],a)},f=r.utils={$helpers:{},$include:i,$string:c,$escape:u,$each:p};r.helper=function(e,t){m[e]=t};var m=r.helpers=f.$helpers;r.onerror=function(e){var t="Template Error\n\n";for(var a in e)t+="<"+a+">\n"+e[a]+"\n\n";"object"==typeof console&&console.error(t)};var h=function(e){return r.onerror(e),function(){return"{Template Error}"}},g=r.compile=function(e,t){function r(a){try{return new l(a,c)+""}catch(r){return t.debug?h(r)():(t.debug=!0,g(e,t)(a))}}t=t||{};for(var i in o)void 0===t[i]&&(t[i]=o[i]);var c=t.filename;try{var l=a(e,t)}catch(s){return s.filename=c||"anonymous",s.name="Syntax Error",h(s)}return r.prototype=l.prototype,r.toString=function(){return l.toString()},c&&t.cache&&(n[c]=r),r},$=f.$each,v="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,I=new RegExp(["\\b"+v.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),_=/^\d[^,]*|,\d[^,]*/g,k=/^,+|,+$/g,N=/^$|,+/;o.openTag="{{",o.closeTag="}}";var w=function(e,t){var a=t.split(":"),r=a.shift(),o=a.join(":")||"";return o&&(o=", "+o),"$helpers."+r+"("+e+o+")"};o.parser=function(e){e=e.replace(/^\s/,"");var t=e.split(" "),a=t.shift(),o=t.join(" ");switch(a){case"if":e="if("+o+"){";break;case"else":t="if"===t.shift()?" if("+t.join(" ")+")":"",e="}else"+t+"{";break;case"/if":e="}";break;case"each":var n=t[0]||"$data",i=t[1]||"as",c=t[2]||"$value",l=t[3]||"$index",s=c+","+l;"as"!==i&&(n="[]"),e="$each("+n+",function("+s+"){";break;case"/each":e="});";break;case"echo":e="print("+o+");";break;case"print":case"include":e=a+"("+t.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(o)){var u=!0;0===e.indexOf("#")&&(e=e.substr(1),u=!1);for(var d=0,p=e.split("|"),f=p.length,m=p[d++];f>d;d++)m=w(m,p[d]);e=(u?"=":"=#")+m}else e=r.helpers[a]?"=#"+a+"("+t.join(",")+");":"="+e}return e},"function"==typeof define?define(function(){return r}):"undefined"!=typeof exports?module.exports=r:this.template=r}();var storage=window.sessionStorage,key="autoParts_crumbs";$(function(){var e="";switch(Number($(".choose-style").attr("data-type"))){case 1:e=_oeSearchPlaceholder;break;case 2:e=_vinSearchPlaceholder;break;default:e=_keywordSearchPlaceholder}$("#car-type-search-input").bind("keypress",function(e){13==e.keyCode&&$("#car-type-head-searchBtn").trigger("click")}).attr("placeholder",e)});var _OfferGoodsList=[],_oeNumber,_partName,Shopping={init:function(){$(".top-shopping-cart").click(function(){})},getOfferInfo:function(e,t,a,r){_partName=r;var o=$("#offerInfoContent");Shopping.toGetOfferInfo(e,t,a,o,r)},toGetOfferInfo:function(e,t,a,r,o){var n={carId:e,oeNum:t};void 0!==a&&null!==a&&0!=a&&(n.qualityId=a),JqUI.loading(r);var i={unblockUI:function(){JqUI.unblockUI(r)}};JqAjax.get("/goodsDetail/getGoodsQuote",function(a){a.success?(_oeNumber=t,_partName=o,r.html(template("offerInfoTemplate",a)),Shopping.bindButton(e),_OfferGoodsList=a.data):(r.html("暂无报价信息"),_OfferGoodsList=[]),JqUI.unblockUI(r)},n,i)},bindButton:function(e){$(".join-cart-bt").click(function(){if(Shopping.checkVerifyStatus()){var e=$(this),t=e.attr("data-id"),a=e.parent().prev().find("input[type='text']").val();Shopping.joinCart(e,t,parseInt(a))}}),$(".buy-now-bt").click(function(){if(Shopping.checkVerifyStatus()){for(var e,t=$(this),a=t.attr("data-id"),r=t.parent().prev().find("input[type='text']").val(),o=_OfferGoodsList.length,n=0;o>n;n++)if(a==_OfferGoodsList[n].id){e=_OfferGoodsList[n];break}var i={goodsId:e.goodsId,partName:_partName,goodsPrice:e.price},c=$("body");JqUI.blockUI(c),Ajax.post({url:"/shopping/checkGoodsForBuyNow",data:i,success:function(t){JqUI.unblockUI(c),t.success?window.location.href="/shopping/purchaseImmediately?goodsId="+e.goodsId+"&oeNumber="+_oeNumber+"&goodsNumber="+r+"&sellerId="+e.thirdPartId+"&partName="+_partName+"&sellerName="+e.companyName+"&sellerTel="+e.sellerTel:LayerUtil.msg(t.message)}})}}),$(".contact-seller-bt").click(function(){if(Shopping.checkVerifyStatus()){var e=$(this).data("orgid");TqmallChat.openChatWindow(e,"yunpei",void 0,WishChatMap.bottom_url,WishChatMap.bottom_url_btn_name,WishChatMap.guide_url,WishChatMap.guide_content)}})},addGoods:function(e,t){var a=$("body");JqUI.blockUI(a),JqAjax.postJson("/shopping/joinShoppingCart",function(e){JqUI.unblockUI(a),e.success?(LayerUtil.msg("成功加入购物车"),ShoppingCart.reloadCartNum()):LayerUtil.msg("加入购物车失败")},JSON.stringify(e),TimeoutCallback)},joinCart:function(e,t,a){for(var r=$("#partName")[0].innerText,o=_OfferGoodsList.length,n=0;o>n;n++){var i=_OfferGoodsList[n];if(t==i.id){var c={goodsId:i.goodsId,goodsSn:i.newGoodsSn,partName:r,oeNumber:_oeNumber,goodsNumber:a,sellerId:i.thirdPartId,sellerTelephone:i.sellerTel,sellerCompanyName:i.companyName};Shopping.addGoods(c,e);break}}ShoppingCart.reloadCartNum()},checkVerifyStatus:function(){return 1!==IsVerifySuccessShop?(EPC.alertFuc("您尚未成为汽配管家会员，无法使用此功能！请至左上角进行认证"),!1):!0}},_body=$("body"),_carListMap,_carArray,_goodsId,_modelId,_oeNumber,_carId,_partName;template.helper("numberFormatHelper",function(e){return EPC.parseMoney(e)}),$(function(){init_variable(),getCarByGoodsId(),initQualitySelect(),ImgUtil.init($("#bigPicture")),SetCityCallback.callback=function(){getOfferInfo()}});