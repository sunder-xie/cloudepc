function getUserAddress(){Ajax.get({url:"/user/getDefaultAddress",async:!1,success:function(e){if(e.success){var t=e.data;_province=t.provinceId,_city=t.cityId,_district=t.districtId,_street=t.streetId,$("#wishListMaker").val(t.contactsName),$("#mobile").val(t.mobile),$("#address").val(t.address)}}})}function initSelect2(){$("#province").select2(),$("#city").select2(),$("#district").select2(),$("#street").select2()}function clearSelect(e){var t=$("#"+e).get(0);void 0!==t&&(t.options.length=1,$(t).val(0).select2())}function getRegionInfo(e,t,r){clearSelect(r);var i=$("#"+r);JqAjax.get("/region/subRegions",function(e){for(var r=0;r<e.length;r++){var c=$("<option></option>");c.val(e[r].id),c.text(e[r].regionName),i.append(c)}i.val(t).select2()},{pid:e})}function chooseProvince(e){var t=$(e).val();0==t?clearSelect("city"):getRegionInfo(t,0,"city"),clearSelect("district"),clearSelect("street")}function chooseCity(e){var t=$(e).val();0==t?clearSelect("district"):getRegionInfo(t,0,"district"),clearSelect("street")}function chooseDistrict(e){var t=$(e).val();return 0==t?void clearSelect("street"):void getRegionInfo(t,0,"street")}function choosePayType(e){$(e).parent().children("img").removeClass("border-set"),$(e).addClass("border-set")}function confirm(e){var t=checkUserAddress(!0,e);return"boolean"==typeof t?!1:(JqUI.loading(_body),void JqAjax.post("/wish/createOrder",function(e){if(e.success){var r=$(".border-set").data("code");if(void 0==r)return;switch(r){case"alipay":window.location.href="/wish/pay/aliPay?orderId="+t.offerId;break;case"lianpay":window.location.href="/wish/pay/selectUnionPay?orderId="+t.offerId}}else EPC.alertFuc("创建订单失败，"+e.message);JqUI.unblockUI(_body)},JSON.stringify(t),void 0,"application/json"))}function emptyId(e){return void 0==e||null==e||0==e?!0:!1}function checkUserAddress(e,t){var r=new Array("!","@","#","'",'"',"$","%","^","&","_","=","~","`","{","}",";",":",",","?","<",">"),i=new RegExp("\\"+r.join("|\\"),"gi"),c=$("#supplier_name").val().trim(),a=$("#wishListMaker").val().trim(),s=$("#mobile").val().trim(),n=$("#province").val(),o=$("#city").val(),l=$("#district").val(),d=$("#street").val(),u=$("#address").val().trim(),f=$("#payType").data("value"),v=$("#paymentList .border-set").data("value"),p=$(t).data("wish-id"),g=$(t).data("offer-id");if(c=c.replace(i,""),a=a.replace(i,""),u=u.replace(i,""),c.length<=0)return e&&(EPC.alertFuc("门店名称不能为空！"),$("#supplier_name").focus()),!1;if(a.length<=0)return e&&(EPC.alertFuc("联系人不能为空！"),$("#wishListMaker").focus()),!1;if(emptyId(n))return e&&(EPC.alertFuc("请选择省份！"),$("#province").click()),!1;if(emptyId(o))return e&&(EPC.alertFuc("请选择城市！"),$("#city").click()),!1;if(emptyId(l))return e&&(EPC.alertFuc("请选择区县！"),$("#district").click()),!1;if(emptyId(d))return e&&(EPC.alertFuc("请选择街道！"),$("#street").click()),!1;if(u.length<=0)return e&&(EPC.alertFuc("请填写详细信息！"),$("#address").focus()),!1;if(u.length<5||u.length>120)return e&&(EPC.alertFuc("详细地址请控制在5-120字以内！"),$("#address").focus()),!1;if(void 0==v)return e&&EPC.alertFuc("请选择支付方式！"),!1;var y=[],I=$("ul[name='goodsItems']");I.each(function(e,t){y.push($(t).data("value"))});var h={companyName:c,province:n,city:o,district:l,street:d,address:u,mobile:s,telephone:s,consignee:a,wishId:p,offerId:g,payId:v,shippingId:f,saleTel:$("#saleTel").val().trim(),offerGoodsIds:y.join(",")};return h}var _body=$("body"),_province=0,_city=0,_district=0,_street=0;$(function(){getUserAddress(),getRegionInfo(1,_province,"province"),_province>0&&getRegionInfo(_province,_city,"city"),_city>0&&getRegionInfo(_city,_district,"district"),_district>0&&getRegionInfo(_district,_street,"street")});