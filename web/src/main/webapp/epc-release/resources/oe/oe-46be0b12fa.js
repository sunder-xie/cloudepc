function changeSearchType(e,a){TipUtil.removeTip();var t=$("#car-type-search-input");switch(t.val(""),$(".choose-style").removeClass("choose-style"),$(a).addClass("choose-style"),e){case 0:t.unbind("keyup"),t.attr("placeholder",_keywordSearchPlaceholder),t.removeAttr("maxlength");break;case 1:t.unbind("keyup").on("keyup",function(){$(this).val($(this).val().replace(/[\u4E00-\u9FA5]/g,""))}),t.attr("placeholder",_oeSearchPlaceholder),t.removeAttr("maxlength");break;default:t.unbind("keyup").on("keyup",function(){$(this).val($(this).val().replace(/[\u4E00-\u9FA5]/g,""))}),t.attr("placeholder",_vinSearchPlaceholder),t.attr("maxlength",_vinLength)}t.focus()}function carSearch(){var e=$("#car-type-search-input");TipUtil.destroyTip(e);var a=Number($(".choose-style").attr("data-type")),t=e.val().trim();if(0==a){if(""==t)return TipUtil.tooltipFun(e,_keywordSearchTip,"bottom"),!1;window.location.href="/autoParts/goods/keyword?q="+t}if(1==a){if(""==t)return TipUtil.tooltipFun(e,_oeSearchTip,"bottom"),!1;window.location.href="/autoParts/goods/oe?oem="+t}if(2==a){if(t=t.toUpperCase(),!EPC.isVin(t))return TipUtil.tooltipFun(e,_vinSearchTip,"bottom"),!1;JqAjax.post("/epc/car/getOnlineCarByVin",getVinResult,{vin:t})}}function getVinResult(e){var a=$("#car-type-search-input").val().trim(),t="/autoParts/category/category?carId=CARID&vinNumber="+a;if(e.success){var n=e.data;if(1==n.length)window.location.href=t.replace("CARID",n[0].id)+"&seriesId="+n[0].seriesId;else{var o=template("choose_car_template",{list:n});EPC.alertFuc(o),$(".choose_car").unbind("click").click(function(){var e=$(this).attr("data-id"),a=$(this).attr("data-sid");window.location.href=t.replace("CARID",e)+"&seriesId="+a})}}else EPC.alertFuc("很抱歉，未查询到您提交的车辆信息。");return!1}function handleCarModel(e){_carModelList=e,_carModelList.sort(function(e,a){return e.name>=a.name?1:-1}),_carModelMap={},$.each(e,function(e,a){var t=_carModelMap[a.brand];void 0==t&&(t=[],_carModelMap[a.brand]=t),t.push(a)})}function searchGoods(e){_searchValue=$("#searchValue").val(),$("#car-type-search-input").val(_searchValue),_searchType=Number($(".choose-style").attr("data-type")),getGoods(e,-1,-1,-1,!0)}function getGoods(e,a,t,n,o){var r={pageIndex:e,pageSize:_goodsSearchPageSize};switch(_searchType){case 1:r.oeNumber=_searchValue;break;default:r.keyword=_searchValue}-1!=a&&(r.modelId=a),-1!=t&&(r.cateId=t),JqUI.loading(_body),JqAjax.get("/autoParts/goodsSearch",function(a){if($(".no-data-div").remove(),a.success){o&&($("#goods-filter").removeClass("hidden"),$("#goods-content").removeClass("hidden")),$("#content-left").removeClass("hidden"),$("#content-right").removeClass("hidden"),$("#SearchResult").html(template("goodsSearchTemplate",{dataList:a.data.goodsInfo})),choiceOe($("#SearchResult tr:first"));var t=Math.ceil(a.data.num/_goodsSearchPageSize);JqPagination.updatePage(t,e,null),handleGoods(a.data.goodsInfo),o&&handleGoodsFilter(a)}else o?$("#content").html(template("goodsSearchNoDataTemplate")):($("#content-left").addClass("hidden"),$("#content-right").addClass("hidden"),$("#goods-content").append(template("goodsSearchNoDataTemplate")));JqUI.unblockUI(_body)},r)}function handleGoodsFilter(e){handleCarModel(e.data.carInfo),$("#carBrandSelect").html(template("brandSelectTemplate",{data:_carModelMap})),$("#carModelSelect").html(template("modelSelectTemplate",{dataList:_carModelList}));var a=e.data.cateInfo;a.sort(function(e,a){return e.catName>=a.catName?1:-1}),$("#cateSelect").html(template("cateSelectTemplate",{dataList:a})),bandGoodsFilterSelect()}function bandGoodsFilterSelect(){$("#carBrandSelect").change(function(){var e,a=this.value;"-1"==a?e=_carModelList:(e=_carModelMap[a],e.sort(function(e,a){return e.name>=a.name?1:-1})),$("#carModelSelect").html(template("modelSelectTemplate",{dataList:e})),$("#select2-carModelSelect-container").text("选择车型").attr("title","选择车型")}),$("#carModelSelect").change(function(){goodsFilter(1)}),$("#cateSelect").change(function(){goodsFilter(1)})}function goodsFilter(e){var a=$("#carModelSelect").val(),t=$("#cateSelect").val(),n=$("#carBrandSelect").val();getGoods(e,a,t,n,!1)}function choiceOe(e){$(".thirdList-backColor").removeClass("thirdList-backColor"),$(e).addClass("thirdList-backColor"),_goodsId=Number($(e).attr("data-id"));var a=_goodsDetailMap[_goodsId];if(void 0===a)JqAjax.get("/autoParts/carModelForGoods",function(e){e.success?($("#CarModel").html(template("carModelTemplate",e.data)),$(".car-model-span").mouseover(function(){carModelMouseOver(this)}),carModelMouseOver($(".car-model-span:first"))):$("#CarModel").html("没有适配车型")},{goodsId:_goodsId});else if(null===a)$("#CarModel").html("没有适配车型");else{a.carMap.modelId=a.modelId,$("#CarModel").html(template("carModelTemplate",a.carMap));var t="";null!==a.modelSubjoin&&(t=a.modelSubjoin.goodsCarRemarks),$(e).children().find(".goods-car-remark").html(t+"（"+a.modelName+"）"),$(".car-model-span").mouseover(function(){carModelMouseOver(this)})}}function enterOeInfo(e){window.location.href="/autoParts/goods/goodsDetail?from=GOODS_DETAIL&goodsId="+e+"&modelId="+_modelId+"&st="+$("#searchType").val()}function selectCarModel(e){_modelId=$(e).attr("data-id"),window.location.href="/autoParts/goods/goodsDetail?from=GOODS_DETAIL&goodsId="+_goodsId+"&modelId="+_modelId+"&st="+$("#searchType").val()}function carModelMouseOver(e){$(".car-model-selected").removeClass("car-model-selected"),$(e).addClass("car-model-selected"),_modelId=$(e).attr("data-id");var a=$(e).attr("data-name"),t=_goodsId+"_"+_modelId,n=_goodsCarRemarkMap[t];return void 0!==n?void(null!==n&&$(".thirdList-backColor > .goods-car-remark").html(n.goodsCarRemarks+"（"+a+"）")):void JqAjax.get("/autoParts/getSubjoinByGoodsModel",function(e){e.success?($(".thirdList-backColor > .goods-car-remark").html(e.data.goodsCarRemarks+"（"+a+"）"),_goodsCarRemarkMap[t]=e.data):_goodsCarRemarkMap[t]=null},{goodsId:_goodsId,modelId:_modelId})}function handleGoods(e){for(var a=e.length,t=1;a>t;t++){var n=e[t].id;JqAjax.get("/autoParts/modelAndSubjoinForGoods",function(e){_goodsDetailMap[e.goodsId]=e,null!=e&&null!=e.modelSubjoin&&$("#goodsCarRemark"+e.goodsId).html(e.modelSubjoin.goodsCarRemarks+"（"+e.modelName+"）")},{goodsId:n})}}if(function(e){"use strict";e.jqPagination=function(a,t){var n=this;n.$el=e(a),n.el=a,n.$input=n.$el.find("input"),n.$el.data("jqPagination",n),n.init=function(){n.options=e.extend({},e.jqPagination.defaultOptions,t),null===n.options.max_page&&(void 0!==n.$input.data("max-page")?n.options.max_page=n.$input.data("max-page"):n.options.max_page=1),void 0!==n.$input.data("current-page")&&n.isNumber(n.$input.data("current-page"))&&(n.options.current_page=n.$input.data("current-page")),n.$input.removeAttr("readonly"),n.updateInput(!0),n.$input.on("focus.jqPagination mouseup.jqPagination",function(a){if("focus"===a.type){var t=parseInt(n.options.current_page,10);e(this).val(t).select()}return"mouseup"===a.type?!1:void 0}),n.$input.on("blur.jqPagination keydown.jqPagination",function(a){var t=e(this),o=parseInt(n.options.current_page,10);27===a.keyCode&&(t.val(o),t.blur()),13===a.keyCode&&t.blur(),"blur"===a.type&&n.setPage(t.val())}),n.$el.on("click.jqPagination","a",function(a){var t=e(this);return t.hasClass("disabled")?!1:void(a.metaKey||a.ctrlKey||(a.preventDefault(),n.setPage(t.data("action"))))})},n.setPage=function(e,a){if(void 0===e)return n.options.current_page;var t=parseInt(n.options.current_page,10),o=parseInt(n.options.max_page,10);if(isNaN(parseInt(e,10)))switch(e){case"first":e=1;break;case"prev":case"previous":e=t-1;break;case"next":e=t+1;break;case"last":e=o}return e=parseInt(e,10),isNaN(e)||1>e||e>o?(n.setInputValue(t),!1):(n.options.current_page=e,n.$input.data("current-page",e),void n.updateInput(a))},n.setMaxPage=function(e,a){return void 0===e?n.options.max_page:n.isNumber(e)?e<n.options.current_page?(console.error("jqPagination: max_page lower than current_page"),!1):(n.options.max_page=e,n.$input.data("max-page",e),void n.updateInput(a)):(console.error("jqPagination: max_page is not a number"),!1)},n.updateInput=function(e){var a=parseInt(n.options.current_page,10);n.setInputValue(a),n.setLinks(a),e!==!0&&n.options.paged(a)},n.setInputValue=function(e){var a=n.options.page_string,t=n.options.max_page;a=a.replace("{current_page}",e).replace("{max_page}",t),n.$input.val(a)},n.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n.setLinks=function(e){var a=n.options.link_string,t=parseInt(n.options.current_page,10),o=parseInt(n.options.max_page,10);if(""!==a){var r=t-1;1>r&&(r=1);var i=t+1;i>o&&(i=o),n.$el.find("a.first").attr("href",a.replace("{page_number}","1")),n.$el.find("a.prev, a.previous").attr("href",a.replace("{page_number}",r)),n.$el.find("a.next").attr("href",a.replace("{page_number}",i)),n.$el.find("a.last").attr("href",a.replace("{page_number}",o))}n.$el.find("a").removeClass("disabled"),t===o&&n.$el.find(".next, .last").addClass("disabled"),1===t&&n.$el.find(".previous, .first").addClass("disabled")},n.callMethod=function(a,t,o){switch(a.toLowerCase()){case"option":if(void 0===o&&"object"!=typeof t)return n.options[t];var r={trigger:!0},i=!1;e.isPlainObject(t)&&!o?e.extend(r,t):r[t]=o;var s=r.trigger===!1;return void 0!==r.current_page&&(i=n.setPage(r.current_page,s)),void 0!==r.max_page&&(i=n.setMaxPage(r.max_page,s)),i===!1&&console.error("jqPagination: cannot get / set option "+t),i;case"destroy":n.$el.off(".jqPagination").find("*").off(".jqPagination");break;default:return console.error('jqPagination: method "'+a+'" does not exist'),!1}},n.init()},e.jqPagination.defaultOptions={current_page:1,link_string:"",max_page:null,page_string:"Page {current_page} of {max_page}",paged:function(){}},e.fn.jqPagination=function(){var a=this,t=e(a),n=Array.prototype.slice.call(arguments),o=!1;return"string"==typeof n[0]?(void 0===n[2]?o=t.first().data("jqPagination").callMethod(n[0],n[1]):t.each(function(){o=e(this).data("jqPagination").callMethod(n[0],n[1],n[2])}),o):void a.each(function(){new e.jqPagination(this,n[0])})}}(jQuery),!console){var console={},func=function(){return!1};console.log=func,console.info=func,console.warn=func,console.error=func}var JqPagination={initPage:function(e,a,t,n){var o="{current_page}/{max_page}";null!=t&&void 0!=t&&(o=o+"(共"+t+"条)"),$(".pagination").jqPagination({current_page:a,max_page:e,page_string:o,paged:function(e){return n(e),!1}})},updatePage:function(e,a,t){var n="{current_page}/{max_page}";null!=t&&void 0!==t&&(n=n+"(共"+t+"条)");var o=$(".pagination").data("jqPagination");o.options.page_string=n,a>e?(1!=a&&(a-=1),a-this.getCurrentPage()!=0&&o.setPage(a,!0),0==e&&(e=1),o.setMaxPage(e,!0)):(a-this.getCurrentPage()!=0&&o.setPage(a,!0),o.setMaxPage(e,!0))},initCurrentPage:function(e){$(".pagination").jqPagination("option","current_page",e)},getCurrentPage:function(){return $(".pagination").jqPagination("option","current_page")}};!function(){function e(e){return e.replace(_,"").replace(b,",").replace(y,"").replace(P,"").replace(I,"").split(k)}function a(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function t(t,n){function o(e){return p+=e.split(/\n/).length-1,d&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=v[1]+a(e)+v[2]+"\n"),e}function r(a){var t=p;if(c?a=c(a,n):i&&(a=a.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===a.indexOf("=")){var o=u&&!/^=[=#]/.test(a);if(a=a.replace(/^=[=#]?|[\s;]*$/g,""),o){var r=a.replace(/\s*\([^\)]+\)/,"");g[r]||/^(include|print)$/.test(r)||(a="$escape("+a+")")}else a="$string("+a+")";a=v[1]+a+v[2]}return i&&(a="$line="+t+";"+a),$(e(a),function(e){if(e&&!h[e]){var a;a="print"===e?b:"include"===e?y:g[e]?"$utils."+e:f[e]?"$helpers."+e:"$data."+e,P+=e+"="+a+",",h[e]=!0}}),a+"\n"}var i=n.debug,s=n.openTag,l=n.closeTag,c=n.parser,d=n.compress,u=n.escape,p=1,h={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},m="".trim,v=m?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],_=m?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+_+"}",y="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+_+"}",P="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),I=v[0],k="return new String("+v[3]+");";$(t.split(s),function(e){e=e.split(l);var a=e[0],t=e[1];1===e.length?I+=o(a):(I+=r(a),t&&(I+=o(t)))});var M=P+I+k;i&&(M="try{"+M+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+a(t)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var x=new Function("$data","$filename",M);return x.prototype=g,x}catch(C){throw C.temp="function anonymous($data,$filename) {"+M+"}",C}}var n=function(e,a){return"string"==typeof a?m(a,{filename:e}):i(e,a)};n.version="3.0.0",n.config=function(e,a){o[e]=a};var o=n.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},r=n.cache={};n.render=function(e,a){return m(e,a)};var i=n.renderFile=function(e,a){var t=n.get(e)||h({filename:e,name:"Render Error",message:"Template not found"});return a?t(a):t};n.get=function(e){var a;if(r[e])a=r[e];else if("object"==typeof document){var t=document.getElementById(e);if(t){var n=(t.value||t.innerHTML).replace(/^\s*|\s*$/g,"");a=m(n,{filename:e})}}return a};var s=function(e,a){return"string"!=typeof e&&(a=typeof e,"number"===a?e+="":e="function"===a?s(e.call(e)):""),e},l={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},c=function(e){return l[e]},d=function(e){return s(e).replace(/&(?![\w#]+;)|[<>"']/g,c)},u=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,a){var t,n;if(u(e))for(t=0,n=e.length;n>t;t++)a.call(e,e[t],t,e);else for(t in e)a.call(e,e[t],t)},g=n.utils={$helpers:{},$include:i,$string:s,$escape:d,$each:p};n.helper=function(e,a){f[e]=a};var f=n.helpers=g.$helpers;n.onerror=function(e){var a="Template Error\n\n";for(var t in e)a+="<"+t+">\n"+e[t]+"\n\n";"object"==typeof console&&console.error(a)};var h=function(e){return n.onerror(e),function(){return"{Template Error}"}},m=n.compile=function(e,a){function n(t){try{return new l(t,s)+""}catch(n){return a.debug?h(n)():(a.debug=!0,m(e,a)(t))}}a=a||{};for(var i in o)void 0===a[i]&&(a[i]=o[i]);var s=a.filename;try{var l=t(e,a)}catch(c){return c.filename=s||"anonymous",c.name="Syntax Error",h(c)}return n.prototype=l.prototype,n.toString=function(){return l.toString()},s&&a.cache&&(r[s]=n),n},$=g.$each,v="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",_=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,y=new RegExp(["\\b"+v.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),P=/^\d[^,]*|,\d[^,]*/g,I=/^,+|,+$/g,k=/^$|,+/;o.openTag="{{",o.closeTag="}}";var M=function(e,a){var t=a.split(":"),n=t.shift(),o=t.join(":")||"";return o&&(o=", "+o),"$helpers."+n+"("+e+o+")"};o.parser=function(e){e=e.replace(/^\s/,"");var a=e.split(" "),t=a.shift(),o=a.join(" ");switch(t){case"if":e="if("+o+"){";break;case"else":a="if"===a.shift()?" if("+a.join(" ")+")":"",e="}else"+a+"{";break;case"/if":e="}";break;case"each":var r=a[0]||"$data",i=a[1]||"as",s=a[2]||"$value",l=a[3]||"$index",c=s+","+l;"as"!==i&&(r="[]"),e="$each("+r+",function("+c+"){";break;case"/each":e="});";break;case"echo":e="print("+o+");";break;case"print":case"include":e=t+"("+a.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(o)){var d=!0;0===e.indexOf("#")&&(e=e.substr(1),d=!1);for(var u=0,p=e.split("|"),g=p.length,f=p[u++];g>u;u++)f=M(f,p[u]);e=(d?"=":"=#")+f}else e=n.helpers[t]?"=#"+t+"("+a.join(",")+");":"="+e}return e},"function"==typeof define?define(function(){return n}):"undefined"!=typeof exports?module.exports=n:this.template=n}();var storage=window.sessionStorage,key="autoParts_crumbs";$(function(){var e="";switch(Number($(".choose-style").attr("data-type"))){case 1:e=_oeSearchPlaceholder;break;case 2:e=_vinSearchPlaceholder;break;default:e=_keywordSearchPlaceholder}$("#car-type-search-input").bind("keypress",function(e){13==e.keyCode&&$("#car-type-head-searchBtn").trigger("click")}).attr("placeholder",e)});var _body=$("body"),_goodsId=0,_modelId=0;$(function(){$(".filter-select").select2(),searchGoods(1),JqPagination.initPage(1,1,null,goodsFilter)});var _carModelMap,_carModelList,_searchValue="",_searchType=0,_goodsCarRemarkMap={},_goodsDetailMap={};